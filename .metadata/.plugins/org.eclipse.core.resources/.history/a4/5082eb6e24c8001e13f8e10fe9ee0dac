package com.cos.chatapp;

import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import lombok.RequiredArgsConstructor;
import reactor.core.publisher.Flux;


@RequiredArgsConstructor //@RequiredArgsConstructor는 lombok에 해당하며,final 혹은 @NotNull이 붙은 필드의 생성자를 자동으로 만들어준다.
@RestController //데이터를 리턴해주는 서버
public class ChatController {
	
	private final ChatRepository chatRepository;
	
	@GetMapping(value="/sender/{sender}/receiver/{receiver}",produces=MediaType.TEXT_EVENT_STREAM_VALUE)
	//produce는 클라이언트에게 반환하는 HTTP Header의 형식을 지정하는 파라미터이다.
	//MediaType.TEXT_EVENT_STREAM_VALUE는 SSE 프로토콜 형식으로 반환하겠다는 뜻임
	public Flux<Chat> getMsg() {
		return chatRepository.mFindBySender(sender, receiver)
	}
}
